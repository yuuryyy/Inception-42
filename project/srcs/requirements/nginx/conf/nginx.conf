# Basic server settings

server {
	# Nginx will listen for incoming HTTPS traffic on port 443.
	listen 443 ssl;

	server_name ${DOMAIN_NAME}
	

	 # --- SSL/TLS Configuration ---
    # These lines point to the SSL certificate and private key.
	ssl_certificate /etc/nginx/ssl/nginx.crt;
    ssl_certificate_key /etc/nginx/ssl/nginx.key;

	    # Modern, secure SSL protocols.
    ssl_protocols TLSv1.2 TLSv1.3;;
	# listen [::]:443 ssl;
	
	# Note: You should disable gzip for SSL traffic.
	# See: https://bugs.debian.org/773332
	#
	# Read up on ssl_ciphers to ensure a secure configuration.
	# See: https://bugs.debian.org/765782
	#
	# Self signed certs generated by the ssl-cert package
	# Don't use them in a production server!
	#
	# include snippets/snakeoil.conf;

	

	 # --- Content Configuration ---
    # This is the root directory for all web files. It MUST match the
    # path in your WordPress container, as they share the same volume.
	root /var/www/html;

	# This tells Nginx to look for index.php first if a directory is requested.
	index index.php ;
	# index.html ;

	    # --- Location Blocks (The Rulebook) ---
    # Rule 1: Handle all requests for PHP files.
	location ~ \.php$ {
        # This prevents a security vulnerability where Nginx might incorrectly
        # execute a non-existent file.
        try_files $uri =404;

        # This is the magic part. `fastcgi_pass` tells Nginx to forward
        # the request to the `wordpress` service (the service name from
        # docker-compose.yml) on port 9000.
        fastcgi_pass wordpress:9000;

        # Includes standard FastCGI parameters needed for PHP to work correctly.
        include fastcgi_params;

        # This critical parameter tells PHP-FPM the absolute path of the
        # script it needs to execute.
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
    }

	
}
